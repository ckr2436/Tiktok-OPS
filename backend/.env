# =========================
# GMV — Production .env
# =========================

# ---- App ----
APP_NAME=GMV API
APP_VERSION=1.0.0
API_PREFIX=/api/v1
ENV=prod
DEBUG=false

# ---- DB ----
DATABASE_URL=mysql+pymysql://gmv:Cwl.2024668@127.0.0.1:3306/gmv?charset=utf8mb4
DB_POOL_PRE_PING=true
DB_POOL_RECYCLE=3600
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# ---- CORS ----
CORS_ORIGINS=["https://gmv.drafyn.com","https://drafyn.com","https://www.drafyn.com"]
CORS_ALLOW_CREDENTIALS=true

# ---- Host header allow-list ----
ALLOWED_HOSTS=["gmv.drafyn.com","drafyn.com","www.drafyn.com","127.0.0.1","localhost"]

# ---- Cookie / Session ----
SECRET_KEY=jJZHMw-N_iQhLcgdXNtf4xZKocHgqgbCJAVPSlbn3AjVJvTjFjLJbO1Pe_myrTEo
COOKIE_NAME=gmv_session
COOKIE_DOMAIN=.drafyn.com
COOKIE_SECURE=true
COOKIE_SAMESITE=lax
SESSION_MAX_AGE_SECONDS=86400
SESSION_REMEMBER_MAX_AGE_SECONDS=2592000

# ---- Password hashing ----
PBKDF2_ITERATIONS=240000

# ---- Admin Docs（可选）----
ADMIN_DOCS_ENABLE=true
# ADMIN_DOCS_DIR=backend/app/static/admin-docs

# ---- Issuer ----
ISSUER=https://gmv.drafyn.com

# ---- Crypto（主密钥，Base64URL，无=）----
CRYPTO_MASTER_KEY_B64=6PALK4ba_Gju8T7aKmqDMV9sUQ6-lzes9Gx174032Ec

# ---- OAuth · TikTok Business ----
TT_BIZ_PORTAL_AUTH_URL=https://business-api.tiktok.com/portal
TT_BIZ_TOKEN_URL=https://business-api.tiktok.com/open_api/v1.3
OAUTH_SESSION_TTL_SECONDS=3600

# ---- HTTP Client ----
HTTP_CLIENT_TIMEOUT_SECONDS=15.0

# 新增 · Redis / RabbitMQ / Celery
# =========================
# ---- Redis (作 Result Backend) ----
REDIS_URL=redis://127.0.0.1:6379/0
REDIS_SSL=false

# ---- RabbitMQ (AMQP 作为 Broker) ----
RABBITMQ_AMQP_URL=amqp://gmv:Cwl.2024668@127.0.0.1:5679/gmv-ops
RABBITMQ_VHOST=gmv-ops

# ---- Celery ----
# 统一：Broker 用 RabbitMQ，Backend 用 Redis
CELERY_BROKER_URL=amqp://gmv:Cwl.2024668@127.0.0.1:5679/gmv-ops
CELERY_RESULT_BACKEND=redis://127.0.0.1:6379/0

# 队列：默认及扩展队列（建议先保持一致）
CELERY_TASK_DEFAULT_QUEUE=gmv.tasks.default
CELERY_TASK_QUEUES=["gmv.tasks.default","gmv.tasks.events","gmv.tasks.maintenance"]

# 其他配置
CELERY_TIMEZONE=Asia/Shanghai
CELERY_TASK_ACKS_LATE=true
CELERY_TASK_REJECT_ON_WORKER_LOST=true
CELERY_WORKER_CONCURRENCY=4
CELERY_BEAT_ENABLE=true
